<sw-page-header title="로컬 프로젝트 등록">
  <ng-container controls>
    <a routerLink="/pm/local"
       swButton swButtonColor="dark" swButtonSize="xs">
      목록
    </a>
  </ng-container>
</sw-page-header>

<form [formGroup]="formGroup" (ngSubmit)="submit()" class="space-y-4">
  <sw-section title="기본 정보">
    <div class="space-y-4">
      <div class="flex flex-col space-y-2">
        <label class="required">프로젝트명</label>
        <input swInput
               formControlName="name"
               placeholder="프로젝트명 입력">
        <span *ngIf="hasError('required', 'name')" class="error">
          프로젝트명은 필수 입력입니다.
        </span>
      </div>

      <div class="flex flex-col space-y-2">
        <label>연도</label>
        <sw-select-control formControlName="year"
                           [options]="yearOptions"
                           placeholder="프로젝트 수행 연도 입력"></sw-select-control>
      </div>
      <div class="flex flex-col space-y-2">
        <label>학년</label>
        <sw-select-control formControlName="grade"
                           [options]="gradeOptions"
                           placeholder="프로젝트 수행 당시 학년 입력"></sw-select-control>
      </div>
      <div class="flex flex-col space-y-2">
        <label>학기</label>
        <sw-select-control formControlName="semester"
                           [options]="semesterOptions"
                           placeholder="프로젝트 수행 당시 학기 입력"></sw-select-control>
      </div>

      <div class="flex flex-col space-y-2">
        <label class="required">프로젝트 설명</label>
        <textarea swTextarea
                  swTextareaAutoHeight
                  formControlName="description"
                  placeholder="프로젝트에 대한 설명을 100자 이상으로 기술"></textarea>
        <div class="flex">
          <span *ngIf="hasError('min', 'description')" class="error">
            프로젝트 설명은 최소 100자 이상으로 작성해야 합니다.
          </span>
          <div class="text-right text-xs ml-auto">
            <span [class.text-blue-700]="descriptionCount >= 100"
                  [class.text-red-700]="descriptionCount < 100">{{descriptionCount | number}}</span> / 100
          </div>
        </div>
      </div>
    </div>
  </sw-section>

  <sw-section title="이미지 및 비디오">
    <sw-banner-control *ngIf="id"
                       [projectId]="id"
                       formControlName="banners"></sw-banner-control>
  </sw-section>

  <sw-section title="프로젝트 유형">
    <sw-selectable-button-control class="block mb-2"
                                  [options]="projectTypeOptions"
                                  formControlName="projectType"></sw-selectable-button-control>
    <sw-subject-control *ngIf="projectType === '교과목프로젝트'; else ownProjectRef"
                        formControlName="subject"></sw-subject-control>
    <ng-template #ownProjectRef>
      <sw-own-project-control formControlName="ownProject"></sw-own-project-control>
    </ng-template>
  </sw-section>

  <sw-section title="소스코드" description="직접 작성한 코드만 선택하여 업로드, 파일을 불러오는데 시간이 걸릴 수 있음">
    <sw-source-control [projectId]="id"
                       formControlName="source"></sw-source-control>
  </sw-section>

  <sw-section title="팀">
    <sw-team-control formControlName="team"></sw-team-control>
  </sw-section>

  <sw-section title="오픈소스">
    <sw-oss-control formControlName="ossList"></sw-oss-control>
  </sw-section>


  <sw-section title="보고서">
    <sw-document-control [projectId]="id" formControlName="documents"></sw-document-control>
  </sw-section>

  <sw-section class="sticky bottom-0 z-10">
    <div class="flex space-x-2">
      <a [routerLink]="modifying ? ['/pm/local', model._id] : ['/pm/local']"
         swButton swButtonColor="gray" swButtonSize="md" class="block w-full">
        취소
      </a>
      <button type="submit"
              swButton swButtonColor="indigo" swButtonSize="md" class="block w-full">
        {{modifying ? '수정' : '등록'}}
      </button>
    </div>
  </sw-section>
</form>
